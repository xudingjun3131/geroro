+function(t){"use strict";var e={queue:[],current:null,bomb:0,debug:!1},s=[],i=function(t){e.debug&&console.log(t)},a=function(t){if(!isFinite(t)||0>t)t="--:--";else{var e=Math.floor(t/60);t=Math.floor(t)%60,t=(10>e?"0"+e:e)+":"+(10>t?"0"+t:t)}return t},n=function(e){var s="";t.each(e,function(t,e){s+='<li class="nm-songlist-item"><span class="song-info">'+e.title+" - "+e.artist+'</span><span class="song-time">'+a(e.duration)+"</span></li>"}),t(".nm-songlist").html(s)};if(t(".nm-copyright a").attr("href")!=nm_ajax_url.token)return!function(){alert(nm_ajax_url.message)}();var o=function(){var a=this;this.options={selector:"#nm_jplayer"},this.player=this.options.selector,a.init(),t(document).on("click",".nm-list-item",function(){var o=t(this);if(!o.hasClass("is-active")){t(".nm-list-item").removeClass("is-active"),o.addClass("is-active");var r=o.children(".nm-list-content").find(".music-info").text(),l=o.children(".nm-list-content").find(".music-cover").attr("src"),h=o.data("id"),u="dick"+h,c=t(".nm-songs"),d=nm_ajax_url.tworow?" threerow":"";t(".nmplaybar").addClass("appear");var m='<div class="nm-fucker"></div><div class="nm-songs"><div class="nm-songs-title nm-container">'+r+'</div><div class="nm-songs-list nm-container"><ul class="nm-songlist'+d+'"></ul></div></div>';t(".nm-fucker").remove(),c.remove(),o.parent().after(m);var p=o.offset().left-t(".nm-wrapper").offset().left+o.width()/2-10;t(".nm-fucker").css("margin-left",p+"px"),e.current=u,t(".nmplayer-cover").css("background-image","url("+l+")"),s[u]?(n(s[u]),a.play(u,0)):t.ajax({type:"get",dataType:"json",url:nm_ajax_url.ajax_url,data:{action:"nmjson",id:h,type:o.data("type")},success:function(t){if(200==t.msg){t=t.song;var e=t.songs;n(e),s["dick"+h]=e,a.play(u,0)}}}),i(e.current)}}),t(a.player).bind(t.jPlayer.event.play,function(){var i=s[e.current][e.bomb];t(".nm-songlist-item").removeClass("current"),t(".nm-songlist-item").data("status","ready").removeClass("pause"),t(".nm-songlist-item").eq(e.bomb).data("status","play"),t(".nm-songlist-item").eq(e.bomb).addClass("current"),t(".nmplayer-title").html(i.title+" - "+i.artist),t(".nms-play-btn").removeClass("nm-play").addClass("nm-pause")}),t(a.player).bind(t.jPlayer.event.pause,function(){s[e.current][e.bomb];t(".nm-songlist-item").eq(e.bomb).data("status","pause").addClass("pause"),t(".nms-play-btn").removeClass("nm-pause").addClass("nm-play")}),t(a.player).bind(t.jPlayer.event.ended,function(){e.bomb<s[e.current].length?(e.bomb=e.bomb+1,a.play(e.current,e.bomb),t(a.player).jPlayer("play")):e.bomb=0}),t(document).on("click",".nm-songlist-item",function(){var s=t(this),n=s.index();"play"==s.data("status")?a.pause():"pause"==s.data("status")?a.play():(a.play(e.current,n),i("play "+n))}),t(".jp-progress").on("click",function(i){i.preventDefault();var n=t(this),o=n.offset().left,r=(i.pageX-o)/n.width(),l=s[e.current][e.bomb].duration;t(a.player).jPlayer("play",l*r)}),t(document).on("click",".nms-play-btn",function(){var e=t(this);e.hasClass("nm-play")?(i("player continue."),a.play()):(i("player pause."),a.pause())}),t(document).on("click",".nm-loadmore",function(){var e=t(this),s=e.data();e.hasClass("is-active")||(e.addClass("is-active"),t.ajax({url:nm_ajax_url.ajax_url,type:"POST",dataType:"json",data:s,success:function(s){return 200!=s.status?i("error"):(t(".nm-wrapper").append(s.data),s.nav?e.data("paged",s.nav):e.remove(),void e.removeClass("is-active"))}}))}),t(document).on("click",".nm-previous",function(){t(this);i("previous"),a.previous()}),t(document).on("click",".nm-next",function(){t(this);i("next"),a.next()})};o.prototype={init:function(){t(this.player).jPlayer({timeupdate:function(i){var n,n=i.jPlayer.status.currentTime,n=a(n),o=s[e.current][e.bomb].lrc,r=parseInt(i.jPlayer.status.currentTime);void 0!=o[r]&&t(".nmplayer-lrc").html(o[r]),t(".nmplayer-time").text(n),t(".nmplayer-prosess").css("transform","translateX("+(i.jPlayer.status.currentPercentAbsolute-100)+"%)")},supplied:"mp3",swfPath:nm_ajax_url.swfurl,solution:"html,flash",volume:1})},getJSON:function(e){t.ajax({type:"post",dataType:"json",url:nm_ajax_url.ajax_url,data:{action:"nmjson",id:e},success:function(t){if(200==t.msg){t=t.song;var i=t.songs;return s["dick"+e]=i,i}}})},play:function(e,s){"undefined"!=typeof e&&"undefined"!=typeof s&&this.select(e,s),t(this.player).jPlayer("play")},select:function(i,a){e.current=i,e.bomb=a,t(this.player).jPlayer("setMedia",s[e.current][e.bomb])},pause:function(){t(this.player).jPlayer("pause")},next:function(){var t=s[e.current].length;e.bomb!=t-1&&this.play(e.current,e.bomb+1)},previous:function(){e.bomb<1||(i(e.bomb),this.play(e.current,e.bomb-1))}};new o}(jQuery);